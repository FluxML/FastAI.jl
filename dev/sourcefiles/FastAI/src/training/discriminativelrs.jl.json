{"attributes":{"backlinks":[],"path":"/home/runner/.julia/packages/FastAI/5yEHv/src/training/discriminativelrs.jl","title":"FastAI/src/training/discriminativelrs.jl"},"tag":"sourcefile","children":[{"attributes":{"startline":1,"endline":51},"tag":"codeblock","children":[{"attributes":{"docstring":"\"\"\"\n    DiscriminativeLRs(paramgroups, factors)\n\nUse different learning rates based on `paramgroups`. `factors` maps\neach group to a factor that the learning rate is multiplied by, so\nfor a parameter `x` the factor is\n`get(factors, getgroup(paramgroups, x), 1)`.\n\nSee [`ParamGroups`](#).\n\n## Examples\n\nCombining with regular gradient descent, but only training a part of\nthe model.\n\n```julia\nusing Flux.Optimise: Descent, Optimiser\n\nmodel = Chain(Dense(3, 5), Dense(5, 3))\nparamgroups = ParamGroups(IndexGrouper([1, 2]), model)\n\ndlro = DiscriminativeLRs(paramgroups, Dict(1 => 0., 2 => 1.))\no = Optimiser(dlro, Descent(0.1))\n```\n\"\"\"\n"},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_struct","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"struct"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_FALSE","children":[{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.DiscriminativeLRs"},"tag":"reference","children":[{"mimes":{"text/plain":"DiscriminativeLRs"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"pg"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"::"}}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.ParamGroups"},"tag":"reference","children":[{"mimes":{"text/plain":"ParamGroups"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factorfn"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n"}}]}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_function","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"function"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.DiscriminativeLRs"},"tag":"reference","children":[{"mimes":{"text/plain":"DiscriminativeLRs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"pg"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"::"}}]},{"attributes":{"reftype":"symbol","document_id":"references/FastAI.ParamGroups"},"tag":"reference","children":[{"mimes":{"text/plain":"ParamGroups"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factors"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"::"}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Dict"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    "}}]}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_return","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"return"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.DiscriminativeLRs"},"tag":"reference","children":[{"mimes":{"text/plain":"DiscriminativeLRs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"pg"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.group"},"tag":"reference","children":[{"mimes":{"text/plain":"group"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"-> "}}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"get"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factors"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{"reftype":"symbol","document_id":"references/FastAI.group"},"tag":"reference","children":[{"mimes":{"text/plain":"group"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n\n\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_function","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"function"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_where","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply!"},"tag":"reference","children":[{"mimes":{"text/plain":"apply!"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"o"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"::"}}]},{"attributes":{"reftype":"symbol","document_id":"references/FastAI.DiscriminativeLRs"},"tag":"reference","children":[{"mimes":{"text/plain":"DiscriminativeLRs"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Δ"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"::"}}]},{"attributes":{},"tag":"CST_curly","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"AbstractArray"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"{"}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"T"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"}"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"where "}}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"T"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factor"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"convert"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"T"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"o"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factorfn"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.getgroup"},"tag":"reference","children":[{"mimes":{"text/plain":"getgroup"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"o"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"pg"}}]}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n\n    "}}]}]}]},{"attributes":{},"tag":"CST_if","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"if"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factor"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"== "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"one"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"T"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n        "}}]}]}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_return","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"return"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Δ"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"else"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n        "}}]}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_macrocall","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"@."}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_NOTHING","children":[{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Δ"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"*= "}}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"factor"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]}]}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n"}}]}]}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n\n\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_function","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"function"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/FluxTraining"},"tag":"reference","children":[{"mimes":{"text/plain":"FluxTraining"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/FluxTraining.setlearningrate!"},"tag":"reference","children":[{"mimes":{"text/plain":"setlearningrate!"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"optimizer"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"::"}}]},{"attributes":{"reftype":"symbol","document_id":"references/Flux.Optimise.Optimiser"},"tag":"reference","children":[{"mimes":{"text/plain":"Optimiser"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"value"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    "}}]}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/FluxTraining"},"tag":"reference","children":[{"mimes":{"text/plain":"FluxTraining"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/FluxTraining.setlearningrate!"},"tag":"reference","children":[{"mimes":{"text/plain":"setlearningrate!"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_ref","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"optimizer"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"os"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"value"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]},{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]}]}]}]},{"attributes":{"startline":52,"endline":52},"tag":"comment","children":[{"attributes":{},"tag":"h2","children":[{"mimes":{"text/plain":"Tests"}}]}]},{"attributes":{"startline":53,"endline":68},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_macrocall","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"@testset"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_NOTHING","children":[{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"CST_STRING","children":[{"mimes":{"text/plain":"\"DiscriminativeLRs\" "}}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"begin"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.Chain"},"tag":"reference","children":[{"mimes":{"text/plain":"Chain"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.Dense"},"tag":"reference","children":[{"mimes":{"text/plain":"Dense"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"3"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"5"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.Dense"},"tag":"reference","children":[{"mimes":{"text/plain":"Dense"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"5"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"3"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    "}}]}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"pg"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI"},"tag":"reference","children":[{"mimes":{"text/plain":"FastAI"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.ParamGroups"},"tag":"reference","children":[{"mimes":{"text/plain":"ParamGroups"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI"},"tag":"reference","children":[{"mimes":{"text/plain":"FastAI"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.IndexGrouper"},"tag":"reference","children":[{"mimes":{"text/plain":"IndexGrouper"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_vect","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    "}}]}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"o"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.Optimise.Optimiser"},"tag":"reference","children":[{"mimes":{"text/plain":"Optimiser"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"(\n        "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI"},"tag":"reference","children":[{"mimes":{"text/plain":"FastAI"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/FastAI.DiscriminativeLRs"},"tag":"reference","children":[{"mimes":{"text/plain":"DiscriminativeLRs"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"pg"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Dict"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1 "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"=> "}}]},{"attributes":{},"tag":"CST_FLOAT","children":[{"mimes":{"text/plain":"0."}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2 "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"=> "}}]},{"attributes":{},"tag":"CST_FLOAT","children":[{"mimes":{"text/plain":"1."}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":",\n        "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.Descent"},"tag":"reference","children":[{"mimes":{"text/plain":"Descent"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_FLOAT","children":[{"mimes":{"text/plain":"0.1"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    "}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    "}}]}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x1"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_ref","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"weight"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]}]}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x2"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_ref","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"weight"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    # Weight of layer 1 has zeroed gradient\n    "}}]}]}]}]}]},{"attributes":{},"tag":"CST_macrocall","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"@test"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_NOTHING","children":[{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply!"},"tag":"reference","children":[{"mimes":{"text/plain":"apply!"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"o"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x1"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.ones"},"tag":"reference","children":[{"mimes":{"text/plain":"ones"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"size"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x1"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"== "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.zeros"},"tag":"reference","children":[{"mimes":{"text/plain":"zeros"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"size"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x1"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n    # Weight of layer 2 has regular gradient\n    "}}]}]}]}]},{"attributes":{},"tag":"CST_macrocall","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"@test"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_NOTHING","children":[{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply!"},"tag":"reference","children":[{"mimes":{"text/plain":"apply!"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"o"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x2"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/Flux.ones"},"tag":"reference","children":[{"mimes":{"text/plain":"ones"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"size"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x2"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"!= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"fill"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_FLOAT","children":[{"mimes":{"text/plain":"0.1"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"size"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"x1"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]}]}]}]}]}]}