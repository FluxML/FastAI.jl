{"attributes":{"backlinks":[],"path":"/home/runner/work/FastAI.jl/FastAI.jl/docs/notebooks/timeseriesclassification.ipynb","title":"TimeSeries Classification"},"tag":"document","children":[{"attributes":{"nbformat":[4,5],"kernelspec":{"display_name":"Julia 1.7.3","language":"julia","name":"julia-1.7"},"language_info":{"file_extension":".jl","mimetype":"application/julia","name":"julia","version":"1.7.3"}},"tag":"jupyter","children":[{"attributes":{"id":"c83aa3af","execution_count":1},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Pkg"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Pkg"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["activate"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["../../FastAI.jl/"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Pkg"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["instantiate"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"<span class=\"sgr32\"><span class=\"sgr1\">  Activating</span></span> project at `~/Desktop/dev/FastAI.jl`\n"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"5e24a08b","execution_count":2},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.9/ref/Flux"},"tag":"reference","children":["Flux"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"7e4529e7","execution_count":2},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["FastTimeSeries"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.9/ref/Flux"},"tag":"reference","children":["Flux"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"┌ Info: Precompiling FastAI [5d0beca9-ade8-49ae-ad0b-a3cf890e669f]\n└ @ Base loading.jl:1423\n┌ Info: Precompiling FastTimeSeries [5337c758-7610-4451-a331-8357b11df7c6]\n└ @ Base loading.jl:1423\n"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"4c360908"},"tag":"md","children":[{"attributes":{},"tag":"h1","children":["TimeSeries Classification"],"type":"node"}],"type":"node"},{"attributes":{"id":"c4420a53","execution_count":3},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["load"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.Registries.datarecipes"},"tag":"reference","children":["datarecipes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["ecg5000"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"8ba5f855"},"tag":"md","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["getobs"],"type":"node"}," gets us a sample from the TimeSeriesDataset. It returns a tuple with the input time series and the correspodning label."],"type":"node"}],"type":"node"},{"attributes":{"id":"ece7f2ff","execution_count":4},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["input"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["class"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.3.1/ref/MLUtils.getobs"},"tag":"reference","children":["getobs"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["25"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(Float32[-0.28834122 -2.2725453 … 1.722784 1.2959242], &quot;1&quot;)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"a31c504f"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Now we create a learning task for time-series classification. This means using the time-series to predict labels. We will use the ",{"attributes":{},"tag":"code","children":["TimeSeriesRow"],"type":"node"}," block as input and ",{"attributes":{},"tag":"code","children":["Label"],"type":"node"}," block as the target."],"type":"node"}],"type":"node"},{"attributes":{"id":"0db48723","execution_count":5},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.SupervisedTask"},"tag":"reference","children":["SupervisedTask"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.OneHot"},"tag":"reference","children":["OneHot"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.setup"},"tag":"reference","children":["setup"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["TSPreprocessing"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["table"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"SupervisedTask(TimeSeriesRow -&gt; Label{SubString{String}})"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"e7b83d74"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["The encodings passed in transform samples into formats suitable as inputs and outputs for a model"],"type":"node"}],"type":"node"},{"attributes":{"id":"78f8c144"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Let's check that samples from the created data container conform to the blocks of the learning task:"],"type":"node"}],"type":"node"},{"attributes":{"id":"b9f2158a","execution_count":6},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.checkblock"},"tag":"reference","children":["checkblock"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"true"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"38e65919"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To get an overview of the learning task created, and as a sanity test, we can use describetask. This shows us what encodings will be applied to which blocks, and how the predicted ŷ values are decoded."],"type":"node"}],"type":"node"},{"attributes":{"id":"8ed71038","execution_count":7},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.describetask"},"tag":"reference","children":["describetask"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"mimes":{"text/latex":"\\textbf{\\texttt{SupervisedTask} summary}\n\nLearning task for the supervised task with input \\texttt{TimeSeriesRow} and target \\texttt{Label\\{SubString\\{String\\}\\}}. Compatible with \\texttt{model}s that take in \\texttt{TimeSeriesRow} and output \\texttt{OneHotLabel\\{SubString\\{String\\}\\}}.\n\nEncoding a sample (\\texttt{encodesample(task, context, sample)}) is done through the following encodings:\n\n\\begin{tabular}\n{r | r | r | r}\nEncoding & Name & \\texttt{blocks.input} & \\texttt{blocks.target} \\\\\n\\hline\n & \\texttt{(input, target)} & \\texttt{TimeSeriesRow} & \\texttt{Label\\{SubString\\{String\\}\\}} \\\\\n\\texttt{OneHot} &  &  & \\textbf{\\texttt{OneHotLabel\\{SubString\\{String\\}\\}}} \\\\\n\\texttt{TSPreprocessing} & \\texttt{(x, y)} & \\textbf{\\texttt{TimeSeriesRow}} &  \\\\\n\\end{tabular}\n"},"type":"leaf"}],"type":"node"}],"type":"node"},{"attributes":{"id":"1d591875","execution_count":8},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["encoded_sample"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.encodesample"},"tag":"reference","children":["encodesample"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.Training"},"tag":"reference","children":["Training"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(Float32[-0.28937635 -2.2807038 … 1.7289687 1.3005764], Bool[1, 0, 0, 0, 0])"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"0dd4d4da"},"tag":"md","children":[{"attributes":{},"tag":"h3","children":["Visualization Tools for TimeSeries"],"type":"node"}],"type":"node"},{"attributes":{"id":"faa0716f","execution_count":9},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.3.1/ref/MLUtils.getobs"},"tag":"reference","children":["getobs"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(Float32[-0.11252183 -2.8272038 … 0.92528623 0.19313742], &quot;1&quot;)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"249ca5d5","execution_count":null},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.showsample"},"tag":"reference","children":["showsample"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"601990da","execution_count":null},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.showblock"},"tag":"reference","children":["showblock"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"39d96203"},"tag":"md","children":[{"attributes":{},"tag":"h3","children":["Training"],"type":"node"}],"type":"node"},{"attributes":{"id":"904b451b"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We will use a StackedLSTM as a backbone model, and a Dense layer at the front for classification. ",{"attributes":{},"tag":"code","children":["taskmodel"],"type":"node"}," knows how to do this by looking at the datablocks used."],"type":"node"}],"type":"node"},{"attributes":{"id":"fed9610b","execution_count":13},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["backbone"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FastTimeSeries"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["Models"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["StackedLSTM"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["16"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["10"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"d60848d0","execution_count":15},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.taskmodel"},"tag":"reference","children":["taskmodel"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["backbone"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"68c4e730"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We can ",{"attributes":{},"tag":"code","children":["tasklossfn"],"type":"node"}," to get a loss function suitable for our task."],"type":"node"}],"type":"node"},{"attributes":{"id":"d5b69c5e","execution_count":16},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["lossfn"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.tasklossfn"},"tag":"reference","children":["tasklossfn"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"logitcrossentropy (generic function with 1 method)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"f8d2f260"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Next we create a pair of training and validation data loaders. They take care of batching and loading the data in parallel in the background."],"type":"node"}],"type":"node"},{"attributes":{"id":"e82a176e","execution_count":17},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["traindl"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["validdl"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.taskdataloaders"},"tag":"reference","children":["taskdataloaders"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["16"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"ec9994f1"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We will use an ",{"attributes":{},"tag":"code","children":["Adam"],"type":"node"}," optimzer for this task."],"type":"node"}],"type":"node"},{"attributes":{"id":"de471de5","execution_count":18},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ADAM"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Float","children":["0.002"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"ADAM(0.002, (0.9, 0.999), 1.0e-8, IdDict{Any, Any}())"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"9de021f7"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We create callbacks to get the accuracy during the training"],"type":"node"}],"type":"node"},{"attributes":{"id":"e4850e19","execution_count":19},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"vect","children":[{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.ToGPU"},"tag":"reference","children":["ToGPU"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.Metrics"},"tag":"reference","children":["Metrics"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.accuracy"},"tag":"reference","children":["accuracy"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"9e1a419e"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["With the addition of an optimizer and a loss function, we can now create a Learner and start training."],"type":"node"}],"type":"node"},{"attributes":{"id":"cfb0a06d","execution_count":20},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.Learner"},"tag":"reference","children":["Learner"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["lossfn"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["traindl"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["validdl"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"11f4f1bb","execution_count":21},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.fitonecycle!"},"tag":"reference","children":["fitonecycle!"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["10"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["0.002"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"┌ Info: The GPU function is being called but the GPU is not accessible. \n│ Defaulting back to the CPU. (No action is required if you want to run on the CPU).\n└ @ Flux /Users/saksham/.julia/packages/Flux/js6mP/src/functor.jl:192\n<span class=\"sgr32\">Epoch 1 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:40</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   1.0 │ 0.95453 │  0.65725 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 1 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   1.0 │ 0.36429 │   0.9082 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 2 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   2.0 │ 0.30034 │   0.9205 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 2 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   2.0 │ 0.28543 │  0.91211 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 3 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼────────┼──────────┤\n│ TrainingPhase │   3.0 │ 0.2677 │  0.92825 │\n└───────────────┴───────┴────────┴──────────┘\n<span class=\"sgr32\">Epoch 3 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   3.0 │ 0.26776 │  0.91895 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 4 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   4.0 │ 0.23461 │   0.9355 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 4 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   4.0 │ 0.27086 │  0.92285 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 5 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   5.0 │ 0.22571 │   0.9375 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 5 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   5.0 │ 0.24774 │  0.93457 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 6 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   6.0 │ 0.21649 │   0.9385 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 6 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   6.0 │ 0.24026 │  0.93359 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 7 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   7.0 │ 0.21095 │  0.93825 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 7 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   7.0 │ 0.23704 │  0.93262 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 8 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   8.0 │ 0.20555 │  0.93975 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 8 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   8.0 │ 0.24263 │  0.93359 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 9 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   9.0 │ 0.20291 │  0.94075 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 9 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   9.0 │ 0.23519 │  0.93457 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 10 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │  10.0 │ 0.19846 │    0.942 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 10 ValidationPhase(): 100%|███████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │  10.0 │ 0.23493 │  0.93457 │\n└─────────────────┴───────┴─────────┴──────────┘\n"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"911f9aa4"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We can save the model for later inference using ",{"attributes":{},"tag":"code","children":["savetaskmodel"],"type":"node"},":"],"type":"node"}],"type":"node"},{"attributes":{"id":"c29a4c9e","execution_count":23},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-273/ref/FastAI.savetaskmodel"},"tag":"reference","children":["savetaskmodel"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["tsclassification.jld2"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["force"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"true","children":["true"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"f28a366b","execution_count":null},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}