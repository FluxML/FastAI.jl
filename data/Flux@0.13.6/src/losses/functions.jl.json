{"attributes":{"backlinks":[],"path":"/home/runner/.julia/packages/Flux/4k0Ls/src/losses/functions.jl","package_id":"Flux@0.13.6","title":"Flux/losses/functions.jl","module_id":"Flux"},"tag":"sourcefile","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"md","children":[{"attributes":{},"tag":"p","children":["In this file, doctests which differ in the printed Float32 values won't fail"],"type":"node"}],"type":"node"},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@cmd","children":[""],"type":"node"},{"attributes":{},"tag":"cmdstring","children":[{"attributes":{},"tag":"```","children":["```"],"type":"node"},{"attributes":{},"tag":"CmdString","children":["@meta\n"],"type":"node"},{"attributes":{},"tag":"CmdString","children":["DocTestFilters = r\"[0-9\\.]+f0\"\n"],"type":"node"},{"attributes":{},"tag":"```","children":["```"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    mae(ŷ, y; agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the loss corresponding to mean absolute error:\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg(abs.(ŷ .- y))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_model = [1.1, 1.9, 3.1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.mae(y_model, 1:3)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.10000000000000009\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.mae"},"tag":"reference","children":["mae"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["abs"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    mse(ŷ, y; agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the loss corresponding to mean square error:\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg((ŷ .- y) .^ 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`mae`](@ref), [`msle`](@ref), [`crossentropy`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_model = [1.1, 1.9, 3.1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_true = 1:3;\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.mse(y_model, y_true)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.010000000000000018\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.mse"},"tag":"reference","children":["mse"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["abs2"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    msle(ŷ, y; agg = mean, ϵ = eps(ŷ))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The loss corresponding to mean squared logarithmic errors, calculated as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg((log.(ŷ .+ ϵ) .- log.(y .+ ϵ)) .^ 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The `ϵ` term provides numerical stability.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Penalizes an under-estimation more than an over-estimatation.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.msle(Float32[1.1, 2.2, 3.3], 1:3)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.009084041f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.msle(Float32[0.9, 1.8, 2.7], 1:3)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.011100831f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.msle"},"tag":"reference","children":["msle"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.epseltype"},"tag":"reference","children":["epseltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["log"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"/","children":["./"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"^","children":[".^"],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    huber_loss(ŷ, y; δ = 1, agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the mean of the [Huber loss](https://en.wikipedia.org/wiki/Huber_loss)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["given the prediction `ŷ` and true values `y`.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["                 | 0.5 * |ŷ - y|^2,            for |ŷ - y| <= δ\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    Huber loss = |\n"],"type":"node"},{"attributes":{},"tag":"String","children":["                 |  δ * (|ŷ - y| - 0.5 * δ), otherwise\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> ŷ = [1.1, 2.1, 3.1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.huber_loss(ŷ, 1:3)  # default δ = 1 > |ŷ - y|\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.005000000000000009\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.huber_loss(ŷ, 1:3, δ=0.05)  # changes behaviour as |ŷ - y| > δ\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.003750000000000005\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.huber_loss"},"tag":"reference","children":["huber_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["δ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.ofeltype"},"tag":"reference","children":["ofeltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n   "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n   "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["abs_error"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["abs"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n   "],"type":"node"},{"attributes":{},"tag":"Comment","children":["#TODO: remove dropgrad when Zygote can handle this function with CuArrays"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n   "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["temp"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Zygote"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["dropgrad"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["abs_error"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"<","children":[".<"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":["  "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["δ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n   "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["x"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.ofeltype"},"tag":"reference","children":["ofeltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["0.5"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n   "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["abs_error"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"^","children":[".^"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["temp"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["x"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["δ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["abs_error"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["x"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["δ"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["temp"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    label_smoothing(y::Union{Number, AbstractArray}, α; dims::Int=1)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Returns smoothed labels, meaning the confidence on label values are relaxed.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["When `y` is given as one-hot vector or batch of one-hot, its calculated as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    y .* (1 - α) .+ α / size(y, dims)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["when `y` is given as a number or batch of numbers for binary classification,\n"],"type":"node"},{"attributes":{},"tag":"String","children":["its calculated as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    y .* (1 - α) .+ α / 2\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["in which case the labels are squeezed towards `0.5`.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["α is a number in interval (0, 1) called the smoothing factor. Higher the\n"],"type":"node"},{"attributes":{},"tag":"String","children":["value of α larger the smoothing of `y`.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["`dims` denotes the one-hot dimension, unless `dims=0` which denotes the application\n"],"type":"node"},{"attributes":{},"tag":"String","children":["of label smoothing to binary distributions encoded in a single number.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y = Flux.onehotbatch([1, 1, 1, 0, 1, 0], 0:1)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×6 OneHotMatrix(::Vector{UInt32}) with eltype Bool:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" ⋅  ⋅  ⋅  1  ⋅  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  1  1  ⋅  1  ⋅\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_smoothed = Flux.label_smoothing(y, 0.2f0)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×6 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.1  0.1  0.1  0.9  0.1  0.9\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.9  0.9  0.9  0.1  0.9  0.1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_sim = softmax(y .* log(2f0))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×6 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.333333  0.333333  0.333333  0.666667  0.333333  0.666667\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.666667  0.666667  0.666667  0.333333  0.666667  0.333333\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_dis = vcat(y_sim[2,:]', y_sim[1,:]')\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×6 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.666667  0.666667  0.666667  0.333333  0.666667  0.333333\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.333333  0.333333  0.333333  0.666667  0.333333  0.666667\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.crossentropy(y_sim, y) < Flux.crossentropy(y_sim, y_smoothed)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.crossentropy(y_dis, y) > Flux.crossentropy(y_dis, y_smoothed)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.label_smoothing"},"tag":"reference","children":["label_smoothing"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"::","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"::","children":["::"],"type":"node"},{"attributes":{},"tag":"curly","children":[{"attributes":{},"tag":"Identifier","children":["Union"],"type":"node"},{"attributes":{},"tag":"{","children":["{"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["AbstractArray"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Number"],"type":"node"},{"attributes":{},"tag":"}","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"::","children":[{"attributes":{},"tag":"Identifier","children":["α"],"type":"node"},{"attributes":{},"tag":"::","children":["::"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Number"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"::","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"::","children":["::"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"if","children":[{"attributes":{},"tag":"if","children":["if"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"!","children":["!"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"comparison","children":[{"attributes":{},"tag":"Integer","children":["0"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"<","children":["<"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["α"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"<","children":["<"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["throw"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ArgumentError"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["α must be between 0 and 1"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"if","children":[{"attributes":{},"tag":"if","children":["if"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"==","children":["=="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["0"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["y_smoothed"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["α"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["α"],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"//","children":["//"],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"}],"type":"node"},{"attributes":{},"tag":"elseif","children":[{"attributes":{},"tag":"elseif","children":["elseif"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"==","children":["=="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["y_smoothed"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["α"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["α"],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"//","children":["//"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["size"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"}],"type":"node"},{"attributes":{},"tag":"else","children":["else"],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["throw"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ArgumentError"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["`dims` should be either 0 or 1"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"return","children":[{"attributes":{},"tag":"return","children":["return"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y_smoothed"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    crossentropy(ŷ, y; dims = 1, ϵ = eps(ŷ), agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the cross entropy between the given probability distributions;\n"],"type":"node"},{"attributes":{},"tag":"String","children":["calculated as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg(-sum(y .* log.(ŷ .+ ϵ); dims))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Cross entropy is typically used as a loss in multi-class classification,\n"],"type":"node"},{"attributes":{},"tag":"String","children":["in which case the labels `y` are given in a one-hot format.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["`dims` specifies the dimension (or the dimensions) containing the class probabilities.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The prediction `ŷ` is supposed to sum to one across `dims`,\n"],"type":"node"},{"attributes":{},"tag":"String","children":["as would be the case with the output of a [softmax](@ref Softmax) operation.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["For numerical stability, it is recommended to use [`logitcrossentropy`](@ref)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["rather than `softmax` followed by `crossentropy` .\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Use [`label_smoothing`](@ref) to smooth the true labels as preprocessing before\n"],"type":"node"},{"attributes":{},"tag":"String","children":["computing the loss.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`logitcrossentropy`](@ref), [`binarycrossentropy`](@ref), [`logitbinarycrossentropy`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_label = Flux.onehotbatch([0, 1, 2, 1, 0], 0:2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×5 OneHotMatrix(::Vector{UInt32}) with eltype Bool:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  ⋅  ⋅  ⋅  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" ⋅  1  ⋅  1  ⋅\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" ⋅  ⋅  1  ⋅  ⋅\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_model = softmax(reshape(-7:7, 3, 5) .* 1f0)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×5 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.0900306  0.0900306  0.0900306  0.0900306  0.0900306\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.244728   0.244728   0.244728   0.244728   0.244728\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.665241   0.665241   0.665241   0.665241   0.665241\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> sum(y_model; dims=1)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["1×5 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1.0  1.0  1.0  1.0  1.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.crossentropy(y_model, y_label)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["1.6076053f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> 5 * ans ≈ Flux.crossentropy(y_model, y_label; agg=sum)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_smooth = Flux.label_smoothing(y_label, 0.15f0)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×5 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.9   0.05  0.05  0.05  0.9\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.05  0.9   0.05  0.9   0.05\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.05  0.05  0.9   0.05  0.05\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.crossentropy(y_model, y_smooth)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["1.5776052f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.crossentropy"},"tag":"reference","children":["crossentropy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.epseltype"},"tag":"reference","children":["epseltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.xlogy"},"tag":"reference","children":["xlogy"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    logitcrossentropy(ŷ, y; dims = 1, agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the cross entropy calculated by\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg(-sum(y .* logsoftmax(ŷ; dims); dims))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["This is mathematically equivalent to `crossentropy(softmax(ŷ), y)`,\n"],"type":"node"},{"attributes":{},"tag":"String","children":["but is more numerically stable than using functions [`crossentropy`](@ref)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["and [softmax](@ref Softmax) separately.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`binarycrossentropy`](@ref), [`logitbinarycrossentropy`](@ref), [`label_smoothing`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_label = Flux.onehotbatch(collect(\"abcabaa\"), 'a':'c')\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×7 OneHotMatrix(::Vector{UInt32}) with eltype Bool:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  ⋅  ⋅  1  ⋅  1  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" ⋅  1  ⋅  ⋅  1  ⋅  ⋅\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" ⋅  ⋅  1  ⋅  ⋅  ⋅  ⋅\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_model = reshape(vcat(-9:0, 0:9, 7.5f0), 3, 7)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×7 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" -9.0  -6.0  -3.0  0.0  2.0  5.0  8.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" -8.0  -5.0  -2.0  0.0  3.0  6.0  9.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" -7.0  -4.0  -1.0  1.0  4.0  7.0  7.5\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.logitcrossentropy(y_model, y_label)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["1.5791205f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.crossentropy(softmax(y_model), y_label)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["1.5791197f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.logitcrossentropy"},"tag":"reference","children":["logitcrossentropy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["logsoftmax"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    binarycrossentropy(ŷ, y; agg = mean, ϵ = eps(ŷ))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the binary cross-entropy loss, computed as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg(@.(-y * log(ŷ + ϵ) - (1 - y) * log(1 - ŷ + ϵ)))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Where typically, the prediction `ŷ` is given by the output of a [sigmoid](@ref Activation-Functions) activation.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The `ϵ` term is included to avoid infinity. Using [`logitbinarycrossentropy`](@ref) is recomended\n"],"type":"node"},{"attributes":{},"tag":"String","children":["over `binarycrossentropy` for numerical stability.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Use [`label_smoothing`](@ref) to smooth the `y` value as preprocessing before\n"],"type":"node"},{"attributes":{},"tag":"String","children":["computing the loss.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`crossentropy`](@ref), [`logitcrossentropy`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Examples\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_bin = Bool[1,0,1]\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3-element Vector{Bool}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_prob = softmax(reshape(vcat(1:3, 3:5), 2, 3) .* 1f0)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×3 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.268941  0.5  0.268941\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.731059  0.5  0.731059\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.binarycrossentropy(y_prob[2,:], y_bin)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.43989f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> all(p -> 0 < p < 1, y_prob[2,:])  # else DomainError\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_hot = Flux.onehotbatch(y_bin, 0:1)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×3 OneHotMatrix(::Vector{UInt32}) with eltype Bool:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" ⋅  1  ⋅\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  ⋅  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.crossentropy(y_prob, y_hot)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.43989f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.binarycrossentropy"},"tag":"reference","children":["binarycrossentropy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.epseltype"},"tag":"reference","children":["epseltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"@","children":["@"],"type":"node"},{"attributes":{},"tag":"@.","children":["."],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.xlogy"},"tag":"reference","children":["xlogy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.xlogy"},"tag":"reference","children":["xlogy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    logitbinarycrossentropy(ŷ, y; agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Mathematically equivalent to\n"],"type":"node"},{"attributes":{},"tag":"String","children":["[`binarycrossentropy(σ(ŷ), y)`](@ref) but is more numerically stable.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`crossentropy`](@ref), [`logitcrossentropy`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Examples\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_bin = Bool[1,0,1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_model = Float32[2, -1, pi]\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3-element Vector{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":["  2.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" -1.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["  3.1415927\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.logitbinarycrossentropy(y_model, y_bin)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.160832f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.binarycrossentropy(sigmoid.(y_model), y_bin)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.16083185f0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.logitbinarycrossentropy"},"tag":"reference","children":["logitbinarycrossentropy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"@","children":["@"],"type":"node"},{"attributes":{},"tag":"@.","children":["."],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["logσ"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    kldivergence(ŷ, y; agg = mean, ϵ = eps(ŷ))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the\n"],"type":"node"},{"attributes":{},"tag":"String","children":["[Kullback-Leibler divergence](https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["between the given probability distributions.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The KL divergence is a measure of how much one probability distribution is different\n"],"type":"node"},{"attributes":{},"tag":"String","children":["from the other. It is always non-negative, and zero only when both the distributions are equal.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> p1 = [1 0; 0 1]\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×2 Matrix{Int64}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> p2 = fill(0.5, 2, 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×2 Matrix{Float64}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.5  0.5\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.5  0.5\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.kldivergence(p2, p1) ≈ log(2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.kldivergence(p2, p1; agg = sum) ≈ 2log(2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.kldivergence(p2, p2; ϵ = 0)  # about -2e-16 with the regulator\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.kldivergence(p1, p2; ϵ = 0)  # about 17.3 with the regulator\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Inf\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.kldivergence"},"tag":"reference","children":["kldivergence"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.epseltype"},"tag":"reference","children":["epseltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["entropy"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.xlogx"},"tag":"reference","children":["xlogx"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["cross_entropy"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.crossentropy"},"tag":"reference","children":["crossentropy"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"return","children":[{"attributes":{},"tag":"return","children":["return"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["entropy"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cross_entropy"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    poisson_loss(ŷ, y; agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return how much the predicted distribution `ŷ` diverges from the expected Poisson\n"],"type":"node"},{"attributes":{},"tag":"String","children":["distribution `y`; calculated as -\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    sum(ŷ .- y .* log.(ŷ)) / size(y, 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["[More information.](https://peltarion.com/knowledge-center/documentation/modeling-view/build-an-ai-model/loss-functions/poisson).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_model = [1, 3, 3];  # data should only take integral values\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.poisson_loss(y_model, 1:3)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.5023128522198171\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.poisson_loss"},"tag":"reference","children":["poisson_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.xlogy"},"tag":"reference","children":["xlogy"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    hinge_loss(ŷ, y; agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the [hinge_loss](https://en.wikipedia.org/wiki/Hinge_loss) given the\n"],"type":"node"},{"attributes":{},"tag":"String","children":["prediction `ŷ` and true labels `y` (containing 1 or -1); calculated as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    sum(max.(0, 1 .- ŷ .* y)) / size(y, 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Usually used with classifiers like Support Vector Machines.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`squared_hinge_loss`](@ref)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_true = [1, -1, 1, 1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_pred = [0.1, 0.3, 1, 1.5];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.hinge_loss(y_pred, y_true)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.55\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.hinge_loss(y_pred[1], y_true[1]) != 0  # same sign but |ŷ| < 1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.hinge_loss(y_pred[end], y_true[end]) == 0  # same sign but |ŷ| >= 1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.hinge_loss(y_pred[2], y_true[2]) != 0 # opposite signs\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.hinge_loss"},"tag":"reference","children":["hinge_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["max"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["0"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    squared_hinge_loss(ŷ, y)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the squared hinge_loss loss given the prediction `ŷ` and true labels `y`\n"],"type":"node"},{"attributes":{},"tag":"String","children":["(containing 1 or -1); calculated as\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    sum((max.(0, 1 .- ŷ .* y)).^2) / size(y, 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Usually used with classifiers like Support Vector Machines.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`hinge_loss`](@ref)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctes\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_true = [1, -1, 1, 1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_pred = [0.1, 0.3, 1, 1.5];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.squared_hinge_loss(y_pred, y_true)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.625\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.squared_hinge_loss(y_pred[1], y_true[1]) != 0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.squared_hinge_loss(y_pred[end], y_true[end]) == 0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.squared_hinge_loss(y_pred[2], y_true[2]) != 0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.squared_hinge_loss"},"tag":"reference","children":["squared_hinge_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["max"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["0"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"^","children":[".^"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    dice_coeff_loss(ŷ, y; smooth = 1)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return a loss based on the dice coefficient.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Used in the [V-Net](https://arxiv.org/abs/1606.04797) image segmentation\n"],"type":"node"},{"attributes":{},"tag":"String","children":["architecture.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The dice coefficient is similar to the F1_score. Loss calculated as:\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    1 - 2*sum(|ŷ .* y| + smooth) / (sum(ŷ.^2) + sum(y.^2) + smooth)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y_pred = [1.1, 2.1, 3.1];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.dice_coeff_loss(y_pred, 1:3)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.000992391663909964\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> 1 - Flux.dice_coeff_loss(y_pred, 1:3)  # ~ F1 score for image segmentation\n"],"type":"node"},{"attributes":{},"tag":"String","children":["0.99900760833609\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.dice_coeff_loss"},"tag":"reference","children":["dice_coeff_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["smooth"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.ofeltype"},"tag":"reference","children":["ofeltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["1.0"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["2"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["smooth"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"/","children":["/"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"^","children":[".^"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"^","children":[".^"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["smooth"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Comment","children":["#TODO agg"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    tversky_loss(ŷ, y; β = 0.7)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the [Tversky loss](https://arxiv.org/abs/1706.05721).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Used with imbalanced data to give more weight to false negatives.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Larger β weigh recall more than precision (by placing more emphasis on false negatives).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Calculated as:\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    1 - sum(|y .* ŷ| + 1) / (sum(y .* ŷ + (1 - β)*(1 .- y) .* ŷ + β*y .* (1 .- ŷ)) + 1)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.tversky_loss"},"tag":"reference","children":["tversky_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["β"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.ofeltype"},"tag":"reference","children":["ofeltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["0.7"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"Comment","children":["#TODO add agg"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["num"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["den"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["β"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["β"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["num"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"/","children":["/"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["den"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    binary_focal_loss(ŷ, y; agg=mean, γ=2, ϵ=eps(ŷ))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the [binary_focal_loss](https://arxiv.org/pdf/1708.02002.pdf)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The input, 'ŷ', is expected to be normalized (i.e. [softmax](@ref Softmax) output).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["For `γ == 0`, the loss is mathematically equivalent to [`Losses.binarycrossentropy`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`Losses.focal_loss`](@ref) for multi-class setting\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y = [0  1  0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["            1  0  1]\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×3 Matrix{Int64}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0  1  0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  0  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> ŷ = [0.268941  0.5  0.268941\n"],"type":"node"},{"attributes":{},"tag":"String","children":["            0.731059  0.5  0.731059]\n"],"type":"node"},{"attributes":{},"tag":"String","children":["2×3 Matrix{Float64}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.268941  0.5  0.268941\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.731059  0.5  0.731059\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.binary_focal_loss(ŷ, y) ≈ 0.0728675615927385\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.binary_focal_loss"},"tag":"reference","children":["binary_focal_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["γ"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.epseltype"},"tag":"reference","children":["epseltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["p_t"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":["  "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["ce"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["log"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["p_t"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["weight"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":[".-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["p_t"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"^","children":[".^"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["γ"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["loss"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["weight"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":[".*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ce"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["loss"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    focal_loss(ŷ, y; dims=1, agg=mean, γ=2, ϵ=eps(ŷ))\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the [focal_loss](https://arxiv.org/pdf/1708.02002.pdf)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["which can be used in classification tasks with highly imbalanced classes.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["It down-weights well-classified examples and focuses on hard examples.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The input, 'ŷ', is expected to be normalized (i.e. [softmax](@ref Softmax) output).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["The modulating factor, `γ`, controls the down-weighting strength.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["For `γ == 0`, the loss is mathematically equivalent to [`Losses.crossentropy`](@ref).\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> y = [1  0  0  0  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":["            0  1  0  1  0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["            0  0  1  0  0]\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×5 Matrix{Int64}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 1  0  0  0  1\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0  1  0  1  0\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0  0  1  0  0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> ŷ = softmax(reshape(-7:7, 3, 5) .* 1f0)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["3×5 Matrix{Float32}:\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.0900306  0.0900306  0.0900306  0.0900306  0.0900306\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.244728   0.244728   0.244728   0.244728   0.244728\n"],"type":"node"},{"attributes":{},"tag":"String","children":[" 0.665241   0.665241   0.665241   0.665241   0.665241\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.focal_loss(ŷ, y) ≈ 1.1277571935622628\n"],"type":"node"},{"attributes":{},"tag":"String","children":["true\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["See also: [`Losses.binary_focal_loss`](@ref) for binary (not one-hot) labels\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.focal_loss"},"tag":"reference","children":["focal_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["γ"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.epseltype"},"tag":"reference","children":["epseltype"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":[".+"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ϵ"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["sum"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"@","children":["@"],"type":"node"},{"attributes":{},"tag":"@.","children":["."],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"^","children":["^"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["γ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["log"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dims"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@doc","children":[""],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["    siamese_contrastive_loss(ŷ, y; margin = 1, agg = mean)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["                                    \n"],"type":"node"},{"attributes":{},"tag":"String","children":["Return the [contrastive loss](http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["which can be useful for training Siamese Networks. It is given by\n"],"type":"node"},{"attributes":{},"tag":"String","children":["                                    \n"],"type":"node"},{"attributes":{},"tag":"String","children":["    agg(@. (1 - y) * ŷ^2 + y * max(0, margin - ŷ)^2)                           \n"],"type":"node"},{"attributes":{},"tag":"String","children":["                                 \n"],"type":"node"},{"attributes":{},"tag":"String","children":["Specify `margin` to set the baseline for distance at which pairs are dissimilar.\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["# Example\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```jldoctest\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> ŷ = [0.5, 1.5, 2.5];\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.siamese_contrastive_loss(ŷ, 1:3)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["-4.833333333333333\n"],"type":"node"},{"attributes":{},"tag":"String","children":["\n"],"type":"node"},{"attributes":{},"tag":"String","children":["julia> Flux.siamese_contrastive_loss(ŷ, 1:3, margin = 2)\n"],"type":"node"},{"attributes":{},"tag":"String","children":["-4.0\n"],"type":"node"},{"attributes":{},"tag":"String","children":["```\n"],"type":"node"},{"attributes":{},"tag":"\"\"\"","children":["\"\"\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux.Losses.siamese_contrastive_loss"},"tag":"reference","children":["siamese_contrastive_loss"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["mean"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"::","children":[{"attributes":{},"tag":"Identifier","children":["margin"],"type":"node"},{"attributes":{},"tag":"::","children":["::"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Real"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["_check_sizes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"&&","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["margin"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"<","children":["<"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["0"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"&&","children":["&&"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["throw"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["DomainError"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["margin"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["Margin must be non-negative"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"return","children":[{"attributes":{},"tag":"return","children":["return"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["agg"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"@","children":["@"],"type":"node"},{"attributes":{},"tag":"@.","children":["."],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"},{"attributes":{},"tag":"^","children":["^"],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"+","children":["+"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["y"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"*","children":["*"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["max"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["0"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["margin"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"-","children":["-"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ŷ"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"^","children":["^"],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"macrocall","children":[{"attributes":{},"tag":"core_@cmd","children":[""],"type":"node"},{"attributes":{},"tag":"cmdstring","children":[{"attributes":{},"tag":"```","children":["```"],"type":"node"},{"attributes":{},"tag":"CmdString","children":["@meta\n"],"type":"node"},{"attributes":{},"tag":"CmdString","children":["DocTestFilters = nothing\n"],"type":"node"},{"attributes":{},"tag":"```","children":["```"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}