{"attributes":{"kind":"function","backlinks":[{"tag":"sourcefile","title":"Flux/src/losses/Losses.jl","docid":"sourcefiles/Flux/src/losses/Losses.jl"},{"tag":"sourcefile","title":"Flux/src/losses/functions.jl","docid":"sourcefiles/Flux/src/losses/functions.jl"}],"methods":[{"line":524,"file":"/home/runner/.julia/packages/Flux/js6mP/src/losses/functions.jl","method_id":"Flux.Losses.focal_loss_1","symbol_id":"Flux.Losses.focal_loss","filedoc":"sourcefiles/Flux/src/losses/functions.jl","signature":"focal_loss(ŷ, y; dims, agg, γ, ϵ)"}],"name":"focal_loss","title":"focal_loss","symbol_id":"Flux.Losses.focal_loss","public":true,"module_id":"Flux.Losses"},"tag":"documentation","children":[{"attributes":{},"tag":"md","children":[{"attributes":{"lang":""},"tag":"codeblock","children":["focal_loss(ŷ, y; dims=1, agg=mean, γ=2, ϵ=eps(ŷ))\n"],"type":"node"},{"attributes":{},"tag":"p","children":["Return the ",{"attributes":{"href":"https://arxiv.org/pdf/1708.02002.pdf","title":""},"tag":"a","children":["focal_loss"],"type":"node"}," which can be used in classification tasks with highly imbalanced classes. It down-weights well-classified examples and focuses on hard examples. The input, 'ŷ', is expected to be normalized (i.e. ",{"attributes":{"reftype":"document","href":"@ref","title":"","document_id":"references/@ref"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["softmax"],"type":"node"}],"type":"node"}," output)."],"type":"node"},{"attributes":{},"tag":"p","children":["The modulating factor, ",{"attributes":{},"tag":"code","children":["γ"],"type":"node"},", controls the down-weighting strength. For ",{"attributes":{},"tag":"code","children":["γ == 0"],"type":"node"},", the loss is mathematically equivalent to ",{"attributes":{"reftype":"document","href":"@ref","title":"","document_id":"references/@ref"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Losses.crossentropy"],"type":"node"}],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"h1","children":["Example"],"type":"node"},{"attributes":{"lang":"jldoctest"},"tag":"codeblock","children":["julia> y = [1  0  0  0  1\n            0  1  0  1  0\n            0  0  1  0  0]\n3×5 Matrix{Int64}:\n 1  0  0  0  1\n 0  1  0  1  0\n 0  0  1  0  0\n\njulia> ŷ = softmax(reshape(-7:7, 3, 5) .* 1f0)\n3×5 Matrix{Float32}:\n 0.0900306  0.0900306  0.0900306  0.0900306  0.0900306\n 0.244728   0.244728   0.244728   0.244728   0.244728\n 0.665241   0.665241   0.665241   0.665241   0.665241\n\njulia> Flux.focal_loss(ŷ, y) ≈ 1.1277571935622628\ntrue\n"],"type":"node"},{"attributes":{},"tag":"p","children":["See also: ",{"attributes":{"reftype":"document","href":"@ref","title":"","document_id":"references/@ref"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Losses.binary_focal_loss"],"type":"node"}],"type":"node"}," for binary (not one-hot) labels"],"type":"node"}],"type":"node"}],"type":"node"}