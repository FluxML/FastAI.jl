{"attributes":{"backlinks":[],"path":"/home/runner/work/FastAI.jl/FastAI.jl/docs/notebooks/tabularclassification.ipynb","title":"Tabular Classification"},"tag":"document","children":[{"attributes":{"nbformat":[4,5],"kernelspec":{"display_name":"Julia (12 threads, FastAI) 1.8.0-rc1","language":"julia","name":"julia-(12-threads,-fastai)-1.8"},"language_info":{"file_extension":".jl","mimetype":"application/julia","name":"julia","version":"1.8.0"}},"tag":"jupyter","children":[{"attributes":{"id":"860c72f9"},"tag":"md","children":[{"attributes":{},"tag":"h1","children":["Tabular Classification"],"type":"node"}],"type":"node"},{"attributes":{"id":"2433a412"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Tabular Classification involves having a categorical column as the target. Here, we'll use the adult sample dataset from fastai and try to predict whether the salary is above 50K or not, making this a binary classification task."],"type":"node"}],"type":"node"},{"attributes":{"id":"bc1f44bd","execution_count":3},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Tables"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.5/ref/FluxTraining"},"tag":"reference","children":["FluxTraining"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.11/ref/Flux"},"tag":"reference","children":["Flux"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"import","children":[{"attributes":{},"tag":"import","children":["import"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"DataAugmentation@0.2.11/ref/DataAugmentation"},"tag":"reference","children":["DataAugmentation"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"19f9ec64"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We can quickly download and get the path of any dataset from fastai by using ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.Registries.datasets"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["datasets"],"type":"node"}],"type":"node"},". Once we have the path, we'll load the data in a ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastTabular@0.1.0/ref/FastTabular.TableDataset"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["TableDataset"],"type":"node"}],"type":"node"},". By default, if we pass in just the path to ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastTabular@0.1.0/ref/FastTabular.TableDataset"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["TableDataset"],"type":"node"}],"type":"node"},", the data is loaded in a ",{"attributes":{},"tag":"code","children":["DataFrame"],"type":"node"},", but we can use any package for accessing our data, and pass an object satisfying the ",{"attributes":{"href":"https://github.com/JuliaData/Tables.jl","title":""},"tag":"a","children":["Tables.jl"],"type":"node"}," interface to it."],"type":"node"}],"type":"node"},{"attributes":{"id":"bc82faca","execution_count":9},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["path"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["joinpath"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["load"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.Registries.datasets"},"tag":"reference","children":["datasets"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["adult_sample"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["adult.csv"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.TableDataset"},"tag":"reference","children":["TableDataset"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.Datasets.loadfile"},"tag":"reference","children":["loadfile"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["path"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"TableDataset{DataFrames.DataFrame}(<span class=\"sgr1\">32561×15 DataFrame</span>\n<span class=\"sgr1\">   Row </span>│<span class=\"sgr1\"> age    workclass          fnlwgt  education      education-num  marit</span> ⋯\n<span class=\"sgr1\">       </span>│<span class=\"sgr90\"> Int64  String31           Int64   String15       Float64?       Strin</span> ⋯\n───────┼────────────────────────────────────────────────────────────────────────\n     1 │    49   Private           101320   Assoc-acdm             12.0   Marr ⋯\n     2 │    44   Private           236746   Masters                14.0   Divo\n     3 │    38   Private            96185   HS-grad      <span class=\"sgr90\">     missing   </span>  Divo\n     4 │    38   Self-emp-inc      112847   Prof-school            15.0   Marr\n     5 │    42   Self-emp-not-inc   82297   7th-8th      <span class=\"sgr90\">     missing   </span>  Marr ⋯\n     6 │    20   Private            63210   HS-grad                 9.0   Neve\n     7 │    49   Private            44434   Some-college           10.0   Divo\n     8 │    37   Private           138940   11th                    7.0   Marr\n     9 │    46   Private           328216   HS-grad                 9.0   Marr ⋯\n    10 │    36   Self-emp-inc      216711   HS-grad      <span class=\"sgr90\">     missing   </span>  Marr\n    11 │    23   Private           529223   Bachelors              13.0   Neve\n   ⋮   │   ⋮            ⋮            ⋮           ⋮              ⋮              ⋱\n 32552 │    60   Private           230545   7th-8th                 4.0   Divo\n 32553 │    39   Private           139743   HS-grad                 9.0   Sepa ⋯\n 32554 │    35   Self-emp-inc      135436   Prof-school            15.0   Marr\n 32555 │    53   Private            35102   Some-college           10.0   Divo\n 32556 │    48   Private           355320   Bachelors              13.0   Marr\n 32557 │    36   Private           297449   Bachelors              13.0   Divo ⋯\n 32558 │    23   ?                 123983   Bachelors              13.0   Neve\n 32559 │    53   Private           157069   Assoc-acdm             12.0   Marr\n 32560 │    32   Local-gov         217296   HS-grad                 9.0   Marr\n 32561 │    26   Private           182308   Some-college           10.0   Marr ⋯\n<span class=\"sgr36\">                                               10 columns and 32540 rows omitted</span>)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"bd63b82d"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["In case our data was present in a different format for eg. parquet, it could be loaded into a data container as follows:"],"type":"node"}],"type":"node"},{"attributes":{"id":"759237b4-6397-40fc-8ec5-eb1188c9906d"},"tag":"md","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Parquet"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.TableDataset"},"tag":"reference","children":["TableDataset"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["read_parquet"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["parquet_path"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"a77c191c"},"tag":"md","children":[{"attributes":{},"tag":"p","children":[{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"MLUtils@0.4.0/ref/MLUtils.mapobs"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["mapobs"],"type":"node"}],"type":"node"}," is used here to split our target column from the rest of the row in a lazy manner, so that each observation consists of a row of inputs and a target variable."],"type":"node"}],"type":"node"},{"attributes":{"id":"3d4b1c5f","execution_count":10},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["splitdata"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.4.0/ref/MLUtils.mapobs"},"tag":"reference","children":["mapobs"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"->","children":[{"attributes":{},"tag":"Identifier","children":["row"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"->","children":["->"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["row"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["row"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["salary"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"7b8ccc2d"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To create a learning task for tabular classification task, we need an input block, an output block, and the encodings to be performed on the data."],"type":"node"},{"attributes":{},"tag":"p","children":["The input block here is a ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastTabular@0.1.0/ref/FastTabular.TableRow"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["TableRow"],"type":"node"}],"type":"node"}," which contains information about the nature of the columns (ie. categorical or continuous) along with an indexable collection mapping categorical column names to a collection with distinct classes in that column. We can get this mapping by using the ",{"attributes":{},"tag":"code","children":["gettransformationdict"],"type":"node"}," task with ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"DataAugmentation@0.2.11/ref/DataAugmentation.Categorify"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["DataAugmentation.Categorify"],"type":"node"}],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"p","children":["The outblock block used is ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.Label"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Label"],"type":"node"}],"type":"node"}," for single column classification and the unique classes have to passed to it."],"type":"node"},{"attributes":{},"tag":"p","children":["This is followed by the encodings which needs to be applied on our input and output blocks. For the input block, we have used the ",{"attributes":{},"tag":"code","children":["gettransforms"],"type":"node"}," function here to get a standard bunch of transformations to apply, but this can be easily customized by passing in any tabular transformation from DataAugmentation.jl or a composition of those, to ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastTabular@0.1.0/ref/FastTabular.TabularPreprocessing"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["TabularPreprocessing"],"type":"node"}],"type":"node"},". In addition to this, we have just one-hot encoded the outblock."],"type":"node"}],"type":"node"},{"attributes":{"id":"dc67d139","execution_count":13},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cont"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.getcoltypes"},"tag":"reference","children":["getcoltypes"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["target"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["salary"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["filter"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"!","children":["!"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["isequal"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["target"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["catdict"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.gettransformdict"},"tag":"reference","children":["gettransformdict"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"DataAugmentation@0.2.11/ref/DataAugmentation"},"tag":"reference","children":["DataAugmentation"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"DataAugmentation@0.2.11/ref/DataAugmentation.Categorify"},"tag":"reference","children":["Categorify"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"574fb149","execution_count":14},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["inputblock"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.TableRow"},"tag":"reference","children":["TableRow"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cont"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["catdict"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["targetblock"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.Label"},"tag":"reference","children":["Label"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["unique"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["table"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["target"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.BlockTask"},"tag":"reference","children":["BlockTask"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["inputblock"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["targetblock"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.setup"},"tag":"reference","children":["setup"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.TabularPreprocessing"},"tag":"reference","children":["TabularPreprocessing"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["inputblock"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.OneHot"},"tag":"reference","children":["OneHot"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"┌ Warning: There is a missing value present for category &#39;occupation&#39; which will be removed from Categorify dict\n└ @ DataAugmentation /home/lorenz/.julia/packages/DataAugmentation/D6ODQ/src/rowtransforms.jl:108\n"},"type":"leaf"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"SupervisedTask(TableRow{8, 6, Dict{Any, Any}} -&gt; Label{InlineStrings.String7})"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"ad69519e"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["In case our initial problem wasn't a classification task, and we had a continuous target column, we would need to perform tabular regression. To create a learning task suitable for regression, we use a ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.Continuous"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Continuous"],"type":"node"}],"type":"node"}," block for representing our target column. This can be done even with multiple continuous target columns by just passing the number of columns in ",{"attributes":{},"tag":"code","children":["Continuous"],"type":"node"},". For example, the task here could be used for 3 targets."],"type":"node"}],"type":"node"},{"attributes":{"id":"b7ec8b56-7aab-47a2-859d-c7ec0ceefff4"},"tag":"md","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["task2"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.BlockTask"},"tag":"reference","children":["BlockTask"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.TableRow"},"tag":"reference","children":["TableRow"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cont"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["catdict"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":[" \n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n        "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.Continuous"},"tag":"reference","children":["Continuous"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.TabularPreprocessing"},"tag":"reference","children":["TabularPreprocessing"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["outputblock"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.Continuous"},"tag":"reference","children":["Continuous"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"5a1d9474"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To get an overview of the learning task created, and as a sanity test, we can use ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.describetask"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["describetask"],"type":"node"}],"type":"node"},". This shows us what encodings will be applied to which blocks, and how the predicted ŷ values are decoded."],"type":"node"}],"type":"node"},{"attributes":{"id":"2630c9d1","execution_count":15},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.describetask"},"tag":"reference","children":["describetask"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"mimes":{"text/latex":"\\textbf{\\texttt{SupervisedTask} summary}\n\nLearning task for the supervised task with input \\texttt{TableRow\\{8, 6, Dict\\{Any, Any\\}\\}} and target \\texttt{Label\\{InlineStrings.String7\\}}. Compatible with \\texttt{model}s that take in \\texttt{FastTabular.EncodedTableRow\\{8, 6, Dict\\{Any, Any\\}\\}} and output \\texttt{OneHotLabel\\{InlineStrings.String7\\}}.\n\nEncoding a sample (\\texttt{encodesample(task, context, sample)}) is done through the following encodings:\n\n\\begin{tabular}\n{r | r | r | r}\nEncoding & Name & \\texttt{blocks.input} & \\texttt{blocks.target} \\\\\n\\hline\n & \\texttt{(input, target)} & \\texttt{TableRow\\{8, 6, Dict\\{Any, Any\\}\\}} & \\texttt{Label\\{InlineStrings.String7\\}} \\\\\n\\texttt{TabularPreprocessing} &  & \\textbf{\\texttt{FastTabular.EncodedTableRow\\{8, 6, Dict\\{Any, Any\\}\\}}} &  \\\\\n\\texttt{OneHot} & \\texttt{(x, y)} &  & \\textbf{\\texttt{OneHotLabel\\{InlineStrings.String7\\}}} \\\\\n\\end{tabular}\n"},"type":"leaf"}],"type":"node"}],"type":"node"},{"attributes":{"id":"bb9da109"},"tag":"md","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["getobs"],"type":"node"}," gets us a row of data from the ",{"attributes":{},"tag":"code","children":["TableDataset"],"type":"node"},", which we encode here. This gives us a tuple with the input and target. The input here is again a tuple, containing the categorical values (which have been label encoded or \"categorified\") and the continuous values (which have been normalized and any missing values have been filled)."],"type":"node"}],"type":"node"},{"attributes":{"id":"e306b703-e47e-450e-83e7-34ff1aae86b4","execution_count":17},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.4.0/ref/MLUtils.getobs"},"tag":"reference","children":["getobs"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["splitdata"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1000"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(<span class=\"sgr1\">DataFrameRow</span>\n<span class=\"sgr1\">  Row </span>│<span class=\"sgr1\"> age    workclass   fnlwgt  education  education-num  marital-status   </span> ⋯\n<span class=\"sgr1\">      </span>│<span class=\"sgr90\"> Int64  String31    Int64   String15   Float64?       String31         </span> ⋯\n──────┼─────────────────────────────────────────────────────────────────────────\n 1000 │    61   State-gov  162678   5th-6th             3.0   Married-civ-spou ⋯\n<span class=\"sgr36\">                                                              10 columns omitted</span>, &quot;&lt;50k&quot;)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"924c717f","execution_count":18},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["x"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.encodesample"},"tag":"reference","children":["encodesample"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.Training"},"tag":"reference","children":["Training"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.4.0/ref/MLUtils.getobs"},"tag":"reference","children":["getobs"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["splitdata"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1000"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(([5, 16, 2, 10, 5, 2, 3, 2], [1.6435221651965317, -0.2567538819371021, -2.751580937680526, -0.14591824281680102, -0.21665620002803673, -0.035428902921319616]), Bool[0, 1])"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"b7105af7"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To get a model suitable for our learning task, we can use ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.taskmodel"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["taskmodel"],"type":"node"}],"type":"node"}," which constructs a suitable model based on the target block."],"type":"node"}],"type":"node"},{"attributes":{"id":"9bdff3ae","execution_count":19},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.taskmodel"},"tag":"reference","children":["taskmodel"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"Chain(\n  Parallel(\n    vcat,\n    Chain(\n      FastTabular.var&quot;#47#49&quot;(),\n      Parallel(\n        vcat,\n        Embedding(10 =&gt; 6),             <span class=\"sgr90\"># 60 parameters</span>\n        Embedding(17 =&gt; 8),             <span class=\"sgr90\"># 136 parameters</span>\n        Embedding(8 =&gt; 5),              <span class=\"sgr90\"># 40 parameters</span>\n        Embedding(17 =&gt; 8),             <span class=\"sgr90\"># 136 parameters</span>\n        Embedding(7 =&gt; 5),              <span class=\"sgr90\"># 35 parameters</span>\n        Embedding(6 =&gt; 4),              <span class=\"sgr90\"># 24 parameters</span>\n        Embedding(3 =&gt; 3),              <span class=\"sgr90\"># 9 parameters</span>\n        Embedding(43 =&gt; 13),            <span class=\"sgr90\"># 559 parameters</span>\n      ),\n      identity,\n    ),\n    BatchNorm(6),                       <span class=\"sgr90\"># 12 parameters, plus 12</span>\n  ),\n  Chain(\n    Dense(58 =&gt; 200, relu; bias=false),  <span class=\"sgr90\"># 11_600 parameters</span>\n    BatchNorm(200),                     <span class=\"sgr90\"># 400 parameters, plus 400</span>\n    identity,\n  ),\n  Chain(\n    Dense(200 =&gt; 100, relu; bias=false),  <span class=\"sgr90\"># 20_000 parameters</span>\n    BatchNorm(100),                     <span class=\"sgr90\"># 200 parameters, plus 200</span>\n    identity,\n  ),\n  Dense(100 =&gt; 2),                      <span class=\"sgr90\"># 202 parameters</span>\n) <span class=\"sgr90\">        # Total: 18 trainable arrays, </span>33_413 parameters,\n<span class=\"sgr90\">          # plus 6 non-trainable, 612 parameters, summarysize </span>134.871 KiB."},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"0fb73fd4"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Of course you can also create a custom backbone using the functions present in ",{"attributes":{},"tag":"code","children":["FastAI.Models"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{"id":"895aa501","execution_count":25},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["cardinalities"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["collect"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["map"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"->","children":[{"attributes":{},"tag":"Identifier","children":["col"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"->","children":["->"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["length"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["catdict"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"Identifier","children":["col"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["ovdict"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["Dict"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["workclass"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=>","children":["=>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["10"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["education"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=>","children":["=>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["12"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["Symbol"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["native-country"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=>","children":["=>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["16"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["overrides"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["collect"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["map"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"->","children":[{"attributes":{},"tag":"Identifier","children":["col"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"->","children":["->"],"type":"node"},{"attributes":{},"tag":"?","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["col"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"in","children":["in"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["keys"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["ovdict"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"?","children":["?"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"Identifier","children":["ovdict"],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"Identifier","children":["col"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["nothing"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cat"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["embedszs"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["_get_emb_sz"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cardinalities"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["overrides"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["catback"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FastTabular"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FastTabular@0.1.0/ref/FastTabular.tabular_embedding_backbone"},"tag":"reference","children":["tabular_embedding_backbone"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["embedszs"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["0.2"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"b55e062d"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We can then pass a named tuple ",{"attributes":{},"tag":"code","children":["(categorical = ..., continuous = ...)"],"type":"node"}," to ",{"attributes":{},"tag":"code","children":["taskmodel"],"type":"node"}," to replace the default backbone."],"type":"node"}],"type":"node"},{"attributes":{"id":"36dc2f05","execution_count":26},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["backbone"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["categorical"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["catback"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["continuous"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":["  "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.11/ref/Flux.BatchNorm"},"tag":"reference","children":["BatchNorm"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["length"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["cont"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.taskmodel"},"tag":"reference","children":["taskmodel"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["backbone"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"Chain(\n  Parallel(\n    vcat,\n    Chain(\n      FastTabular.var&quot;#47#49&quot;(),\n      Parallel(\n        vcat,\n        Embedding(10 =&gt; 10),            <span class=\"sgr90\"># 100 parameters</span>\n        Embedding(17 =&gt; 12),            <span class=\"sgr90\"># 204 parameters</span>\n        Embedding(8 =&gt; 5),              <span class=\"sgr90\"># 40 parameters</span>\n        Embedding(17 =&gt; 8),             <span class=\"sgr90\"># 136 parameters</span>\n        Embedding(7 =&gt; 5),              <span class=\"sgr90\"># 35 parameters</span>\n        Embedding(6 =&gt; 4),              <span class=\"sgr90\"># 24 parameters</span>\n        Embedding(3 =&gt; 3),              <span class=\"sgr90\"># 9 parameters</span>\n        Embedding(43 =&gt; 16),            <span class=\"sgr90\"># 688 parameters</span>\n      ),\n      Dropout(0.2),\n    ),\n    BatchNorm(6),                       <span class=\"sgr90\"># 12 parameters, plus 12</span>\n  ),\n  Chain(\n    Dense(69 =&gt; 200, relu; bias=false),  <span class=\"sgr90\"># 13_800 parameters</span>\n    BatchNorm(200),                     <span class=\"sgr90\"># 400 parameters, plus 400</span>\n    identity,\n  ),\n  Chain(\n    Dense(200 =&gt; 100, relu; bias=false),  <span class=\"sgr90\"># 20_000 parameters</span>\n    BatchNorm(100),                     <span class=\"sgr90\"># 200 parameters, plus 200</span>\n    identity,\n  ),\n  Dense(100 =&gt; 2),                      <span class=\"sgr90\"># 202 parameters</span>\n) <span class=\"sgr90\">        # Total: 18 trainable arrays, </span>35_850 parameters,\n<span class=\"sgr90\">          # plus 6 non-trainable, 612 parameters, summarysize </span>144.453 KiB."},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"22eb6dc7"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To directly get a ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@0.3.5/ref/FluxTraining.Learner"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Learner"],"type":"node"}],"type":"node"}," suitable for our task and data, we can use the ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.tasklearner"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["tasklearner"],"type":"node"}],"type":"node"}," function. This creates both batched data loaders and a model for us."],"type":"node"}],"type":"node"},{"attributes":{"id":"64c2b78e","execution_count":29},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.tasklearner"},"tag":"reference","children":["tasklearner"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["splitdata"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["backbone"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["backbone"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"vect","children":[{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.5/ref/FluxTraining.Metrics"},"tag":"reference","children":["Metrics"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.5/ref/FluxTraining.accuracy"},"tag":"reference","children":["accuracy"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.4.0/ref/MLUtils.batchsize"},"tag":"reference","children":["batchsize"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Integer","children":["128"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"Learner()"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"d5b4b0be"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Once we have a ",{"attributes":{},"tag":"code","children":["Learner"],"type":"node"},", we can call ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FastAI@pr-267/ref/FastAI.fitonecycle!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["fitonecycle!"],"type":"node"}],"type":"node"}," on it to train it for the desired number of epochs:"],"type":"node"}],"type":"node"},{"attributes":{"id":"4eaf21ae-93c8-4d8a-ae98-105b35f5f09a","execution_count":30},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.fitonecycle!"},"tag":"reference","children":["fitonecycle!"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["5"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["0.1"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"<span class=\"sgr32\">Epoch 1 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:55</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   1.0 │ 0.38405 │  0.82442 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 1 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   1.0 │ 0.32253 │  0.85324 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 2 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:01</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   2.0 │ 0.34583 │  0.83736 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 2 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   2.0 │ 0.31372 │  0.85753 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 3 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:01</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   3.0 │ 0.33348 │  0.84085 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 3 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   3.0 │ 0.30714 │  0.85545 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 4 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:01</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   4.0 │ 0.32585 │  0.84717 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 4 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   4.0 │ 0.31087 │  0.85935 │\n└─────────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 5 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:01</span>\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   5.0 │ 0.32124 │    0.851 │\n└───────────────┴───────┴─────────┴──────────┘\n<span class=\"sgr32\">Epoch 5 ValidationPhase(): 100%|████████████████████████| Time: 0:00:00</span>\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   5.0 │ 0.30543 │   0.8586 │\n└─────────────────┴───────┴─────────┴──────────┘\n"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}