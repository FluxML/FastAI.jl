{"attributes":{"backlinks":[],"path":"/home/runner/work/FastAI.jl/FastAI.jl/docs/howto/logtensorboard.md","title":"How to log to TensorBoard"},"tag":"document","children":[{"attributes":{},"tag":"md","children":[{"attributes":{},"tag":"h1","children":["How to log to TensorBoard"],"type":"node"},{"attributes":{},"tag":"p","children":["TensorBoard is a format and viewer for logs of model training and can be used to inspect and compare the results of training runs. We can log step and epoch metrics, hyperparameters and even visualizations to TensorBoard using FluxTraining.jl's logging callbacks."],"type":"node"},{"attributes":{},"tag":"h2","children":["Generating logs"],"type":"node"},{"attributes":{},"tag":"p","children":["To use logging callbacks, we need to pass a log backend, here ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@0.3.4/ref/FluxTraining.TensorBoardBackend"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["TensorBoardBackend"],"type":"node"}],"type":"node"},". This design allows flexibly supporting other logging backends like Weights and Biases or neptune.ai in the future."],"type":"node"},{"attributes":{},"tag":"codecell","children":[{"attributes":{"cell":"main","lang":"julia"},"tag":"codeinput","children":[{"attributes":{"cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["dir"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["mktempdir"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["backend"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.TensorBoardBackend"},"tag":"reference","children":["TensorBoardBackend"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["dir"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"TensorBoardBackend(/tmp/jl_voYSu2)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Then we create callbacks for logging metrics and hyperparameters to that backend:"],"type":"node"},{"attributes":{},"tag":"codecell","children":[{"attributes":{"cell":"main","lang":"julia"},"tag":"codeinput","children":[{"attributes":{"cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["metricscb"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.LogMetrics"},"tag":"reference","children":["LogMetrics"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["backend"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["hparamscb"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.LogHyperParams"},"tag":"reference","children":["LogHyperParams"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["backend"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"LogHyperParams((TensorBoardBackend(/tmp/jl_voYSu2),))"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Like any other callbacks, these can then be passed to a ",{"attributes":{},"tag":"code","children":["Learner"],"type":"node"}," along with other callbacks and we can start training. By using the ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@0.3.4/ref/FluxTraining.Metrics"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Metrics"],"type":"node"}],"type":"node"}," callback we can log metrics other than the loss."],"type":"node"},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"vect","children":[{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["metricscb"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["hparamscb"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.ToGPU"},"tag":"reference","children":["ToGPU"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.Metrics"},"tag":"reference","children":["Metrics"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.accuracy"},"tag":"reference","children":["accuracy"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["_"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["_"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.tasklearner"},"tag":"reference","children":["tasklearner"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@pr-267/ref/FastAI.fitonecycle!"},"tag":"reference","children":["fitonecycle!"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["5"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"h2","children":["Inspecting logs"],"type":"node"},{"attributes":{},"tag":"p","children":["To inspect the logs you will have to install the ",{"attributes":{},"tag":"code","children":["tensorboard"],"type":"node"}," command-line using ",{"attributes":{},"tag":"code","children":["pip"],"type":"node"}," (you can access the command-line in the Julia REPL by pressing ",{"attributes":{},"tag":"code","children":[";"],"type":"node"},")."],"type":"node"},{"attributes":{"lang":""},"tag":"codeblock","children":["shell> pip install tensorboard\n"],"type":"node"},{"attributes":{},"tag":"p","children":["After this one-time installation, you can run it by pointing it to the log directory created above:"],"type":"node"},{"attributes":{"lang":""},"tag":"codeblock","children":["shell> tensorboard --logdir $dir\n"],"type":"node"},{"attributes":{},"tag":"p","children":["This should give you an URL that you can open in a browser which should look like this:"],"type":"node"},{"attributes":{},"tag":"p","children":[{"attributes":{"src":"../../assets/tensorboardscreenshot.png","alt":""},"tag":"img","children":[],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Note that you can also open TensorBoard and it will update as the training progresses."],"type":"node"}],"type":"node"}],"type":"node"}