{"attributes":{"backlinks":[],"path":"/home/runner/work/FastAI.jl/FastAI.jl/docs/notebooks/tsregression.ipynb","title":"tsregression"},"tag":"document","children":[{"attributes":{"nbformat":[4,5],"kernelspec":{"display_name":"Julia 1.7.3","language":"julia","name":"julia-1.7"},"language_info":{"file_extension":".jl","mimetype":"application/julia","name":"julia","version":"1.7.3"}},"tag":"jupyter","children":[{"attributes":{"id":"88626d99"},"tag":"md","children":[{"attributes":{},"tag":"h2","children":["Time Series Regression"],"type":"node"}],"type":"node"},{"attributes":{"id":"e3cce234"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Importing things we would need."],"type":"node"}],"type":"node"},{"attributes":{"id":"a4c955b9","execution_count":2},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI"},"tag":"reference","children":["FastAI"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["FastTimeSeries"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"Flux@0.13.6/ref/Flux"},"tag":"reference","children":["Flux"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"7670a54a"},"tag":"md","children":[{"attributes":{},"tag":"h3","children":["Loading The Data"],"type":"node"},{"attributes":{},"tag":"p","children":["We are going to select a dataset from the recently released Monash, UEA & UCR"],"type":"node"},{"attributes":{},"tag":"p","children":["Time Series Extrinsic Regression Repository (2020) (",{"attributes":{"href":"http://tseregression.org","title":""},"tag":"a","children":["web"],"type":"node"},", ",{"attributes":{"href":"https://arxiv.org/abs/2006.10996","title":""},"tag":"a","children":["paper"],"type":"node"},")."],"type":"node"}],"type":"node"},{"attributes":{"id":"82e17f5e","execution_count":3},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["load"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.Registries.datarecipes"},"tag":"reference","children":["datarecipes"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["appliances_energy"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"3048070b"},"tag":"md","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["getobs"],"type":"node"}," gets us a sample from the TimeSeriesDataset. It returns a tuple with the input time series and the correspodning label."],"type":"node"}],"type":"node"},{"attributes":{"id":"c046f3b4","execution_count":4},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["input"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["label"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"MLUtils@0.2.11/ref/MLUtils.getobs"},"tag":"reference","children":["getobs"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["25"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(Float32[23.7 23.7 … 24.0 24.1; 30.856667 30.663334 … 31.066668 31.23; … ; 40.0 40.0 … 40.0 40.0; 0.6 0.55 … 1.3666667 1.3333334], 11.49f0)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"127b7128"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Now we create a learning task for time-series regression. This means using the time-series to predict labels. We will use the TimeSeriesRow block as input and ",{"attributes":{},"tag":"code","children":["Continuous"],"type":"node"}," block as the target."],"type":"node"}],"type":"node"},{"attributes":{"id":"52ae0acc","execution_count":5},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["TSRegression"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"3586d511"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["The encodings passed in transform samples into formats suitable as inputs and outputs for a model"],"type":"node"}],"type":"node"},{"attributes":{"id":"6af58a5c"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Let's check that samples from the created data container conform to the blocks of the learning task:"],"type":"node"}],"type":"node"},{"attributes":{"id":"f19b9eb8","execution_count":6},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.checkblock"},"tag":"reference","children":["checkblock"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["blocks"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"true"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"4898b64f"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To get an overview of the learning task created, and as a sanity test, we can use describetask. This shows us what encodings will be applied to which blocks, and how the predicted ŷ values are decoded."],"type":"node"}],"type":"node"},{"attributes":{"id":"3156cc21","execution_count":7},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.describetask"},"tag":"reference","children":["describetask"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"mimes":{"text/latex":"\\textbf{\\texttt{SupervisedTask} summary}\n\nLearning task for the supervised task with input \\texttt{TimeSeriesRow} and target \\texttt{Continuous}. Compatible with \\texttt{model}s that take in \\texttt{TimeSeriesRow} and output \\texttt{Continuous}.\n\nEncoding a sample (\\texttt{encodesample(task, context, sample)}) is done through the following encodings:\n\n\\begin{tabular}\n{r | r | r | r}\nEncoding & Name & \\texttt{blocks.input} & \\texttt{blocks.target} \\\\\n\\hline\n & \\texttt{(input, target)} & \\texttt{TimeSeriesRow} & \\texttt{Continuous} \\\\\n\\texttt{ContinuousPreprocessing} &  &  &  \\\\\n\\texttt{TSPreprocessing} & \\texttt{(x, y)} & \\textbf{\\texttt{TimeSeriesRow}} &  \\\\\n\\end{tabular}\n"},"type":"leaf"}],"type":"node"}],"type":"node"},{"attributes":{"id":"5cc2bfa6","execution_count":8},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["encoded_sample"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.encodesample"},"tag":"reference","children":["encodesample"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.Training"},"tag":"reference","children":["Training"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["sample"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"(Float32[1.25567 1.25567 … 1.4426183 1.5049348; -2.3630838 -2.4116828 … -2.3102949 -2.269237; … ; 0.14111246 0.14111246 … 0.14111246 0.14111246; -0.7532581 -0.7651869 … -0.57035017 -0.5783027], Float32[11.49])"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"f8643baf"},"tag":"md","children":[{"attributes":{},"tag":"h3","children":["Training"],"type":"node"}],"type":"node"},{"attributes":{"id":"8e96be2e"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We will use an ",{"attributes":{},"tag":"code","children":["InceptionTime"],"type":"node"}," model for this task."],"type":"node"}],"type":"node"},{"attributes":{"id":"184e33d4","execution_count":9},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FastTimeSeries"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["Models"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["InceptionTime"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["24"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"4743d473"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We can ",{"attributes":{},"tag":"code","children":["tasklossfn"],"type":"node"}," to get a loss function suitable for our task."],"type":"node"}],"type":"node"},{"attributes":{"id":"0f15f1d8","execution_count":10},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["lossfn"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.tasklossfn"},"tag":"reference","children":["tasklossfn"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"mse (generic function with 1 method)"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"be143f4f"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Next we create a pair of training and validation data loaders. They take care of batching and loading the data in parallel in the background."],"type":"node"}],"type":"node"},{"attributes":{"id":"c5f3bbd3","execution_count":11},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["traindl"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["validdl"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.taskdataloaders"},"tag":"reference","children":["taskdataloaders"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["8"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"f3908266"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We will use an ",{"attributes":{},"tag":"code","children":["ADAM"],"type":"node"}," optimzer for this task."],"type":"node"}],"type":"node"},{"attributes":{"id":"3daa1e4f","execution_count":12},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["ADAM"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"ADAM(0.001, (0.9, 0.999), 1.0e-8, IdDict{Any, Any}())"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"6881557c"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["With the addition of an optimizer and a loss function, we can now create a Learner and start training."],"type":"node"}],"type":"node"},{"attributes":{"id":"bfed9199","execution_count":13},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.Learner"},"tag":"reference","children":["Learner"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["lossfn"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["traindl"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["validdl"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"vect","children":[{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@0.3.4/ref/FluxTraining.ToGPU"},"tag":"reference","children":["ToGPU"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"f119acd0","execution_count":14},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.fitonecycle!"},"tag":"reference","children":["fitonecycle!"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["20"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Float","children":["0.03"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"┌ Info: The GPU function is being called but the GPU is not accessible. \n│ Defaulting back to the CPU. (No action is required if you want to run on the CPU).\n└ @ Flux /Users/saksham/.julia/packages/Flux/js6mP/src/functor.jl:192\n<span class=\"sgr32\">Epoch 1 TrainingPhase(): 100%|██████████████████████████| Time: 0:01:40</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   1.0 │ 142.689 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   1.0 │ 9526.84 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 2 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   2.0 │ 36.1776 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   2.0 │ 2761.77 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 3 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   3.0 │ 21.8786 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   3.0 │ 2405.18 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 4 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   4.0 │ 24.9655 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   4.0 │ 581.368 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 5 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   5.0 │ 22.4986 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   5.0 │ 78.5748 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 6 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   6.0 │ 17.6525 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   6.0 │ 31.8414 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 7 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   7.0 │ 16.7812 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   7.0 │ 43.8513 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 8 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   8.0 │ 18.4489 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   8.0 │ 19.5717 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 9 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │   9.0 │ 17.3489 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │   9.0 │ 20.2309 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 10 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:02</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  10.0 │ 13.0602 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  10.0 │ 27.7731 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 11 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:04</span>\n┌───────────────┬───────┬────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│\n├───────────────┼───────┼────────┤\n│ TrainingPhase │  11.0 │ 17.051 │\n└───────────────┴───────┴────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  11.0 │ 16.8113 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 12 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:04</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  12.0 │ 12.0818 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  12.0 │ 23.0781 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 13 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  13.0 │ 14.9439 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  13.0 │ 15.9388 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 14 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│\n├───────────────┼───────┼────────┤\n│ TrainingPhase │  14.0 │ 13.336 │\n└───────────────┴───────┴────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  14.0 │ 15.2863 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 15 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  15.0 │ 11.6416 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  15.0 │ 17.4399 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 16 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│\n├───────────────┼───────┼────────┤\n│ TrainingPhase │  16.0 │ 9.8485 │\n└───────────────┴───────┴────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  16.0 │ 15.5438 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 17 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  17.0 │ 9.37123 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  17.0 │ 15.5285 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 18 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  18.0 │ 10.1838 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  18.0 │ 14.4063 │\n└─────────────────┴───────┴─────────┘\n<span class=\"sgr32\">Epoch 19 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  19.0 │ 9.74364 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│\n├─────────────────┼───────┼────────┤\n│ ValidationPhase │  19.0 │ 14.059 │\n└─────────────────┴───────┴────────┘\n<span class=\"sgr32\">Epoch 20 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:03</span>\n┌───────────────┬───────┬─────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├───────────────┼───────┼─────────┤\n│ TrainingPhase │  20.0 │ 8.15523 │\n└───────────────┴───────┴─────────┘\n┌─────────────────┬───────┬─────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│\n├─────────────────┼───────┼─────────┤\n│ ValidationPhase │  20.0 │ 15.6445 │\n└─────────────────┴───────┴─────────┘\n"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"452ab9bf"},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We can save the model for later inference using ",{"attributes":{},"tag":"code","children":["savetaskmodel"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"3c8337e8","execution_count":15},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FastAI@dev/ref/FastAI.savetaskmodel"},"tag":"reference","children":["savetaskmodel"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["tsregression.jld2"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["task"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["force"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"true","children":["true"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":"41c73d6e","execution_count":null},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}